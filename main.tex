
\documentclass[sigplan, 10pt, acmart, review]{acmart} % Note: remove the [review] option for the final document.
\let\citename\relax

\settopmatter{printfolios=true,printccs=false,printacmref=false}

\acmConference[PL'17]{ACM SIGPLAN Conference on Programming Languages}{January 01--03, 2017}{New York, NY, USA}
\acmYear{2019}
\acmISBN{} % \acmISBN{978-x-xxxx-xxxx-x/YY/MM}
\acmDOI{} % \acmDOI{10.1145/nnnnnnn.nnnnnnn}
\startPage{1}

\setcopyright{none}

\bibliographystyle{ACM-Reference-Format}

\usepackage{booktabs}
\usepackage{subcaption}

\usepackage[
   backend=biber,
   bibencoding=utf8,
   style=alphabetic,
   hyperref=true,
   % citestyle=authoryear-comp,
   backref=false,
   sortlocale=en,
   url=true,
   doi=false,
   eprint=false
 ]{biblatex}
\addbibresource{biblio.bib}

\usepackage{minted}
\setminted{encoding=utf8}

\usepackage{tikz}
\usetikzlibrary{positioning}

\tikzset{
	box/.style = {
		draw = black,
        fill = white,
		rectangle,
		rounded corners = 2pt,
		text centered,
		minimum height = 5mm,
		minimum width = 10mm
	}
}

\begin{document}

\title{Formalising R}

\author{First1 Last1}
\authornote{with author1 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
\affiliation{
  \position{Position1}
  \department{Department1}              %% \department is recommended
  \institution{Institution1}            %% \institution is required
  \streetaddress{Street1 Address1}
  \city{City1}
  \state{State1}
  \postcode{Post-Code1}
  \country{Country1}                    %% \country is recommended
}
\email{first1.last1@inst1.edu}          %% \email is recommended

%% Author with two affiliations and emails.
\author{First2 Last2}
\authornote{with author2 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
\affiliation{
  \position{Position2a}
  \department{Department2a}             %% \department is recommended
  \institution{Institution2a}           %% \institution is required
  \streetaddress{Street2a Address2a}
  \city{City2a}
  \state{State2a}
  \postcode{Post-Code2a}
  \country{Country2a}                   %% \country is recommended
}
\email{first2.last2@inst2a.com}         %% \email is recommended
\affiliation{
  \position{Position2b}
  \department{Department2b}             %% \department is recommended
  \institution{Institution2b}           %% \institution is required
  \streetaddress{Street3b Address2b}
  \city{City2b}
  \state{State2b}
  \postcode{Post-Code2b}
  \country{Country2b}                   %% \country is recommended
}
\email{first2.last2@inst2b.org}         %% \email is recommended

\begin{abstract}
Text of abstract \ldots.
\end{abstract}

% %% 2012 ACM Computing Classification System (CSS) concepts
% %% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
% \begin{CCSXML}
% <ccs2012>
% <concept>
% <concept_id>10011007.10011006.10011008</concept_id>
% <concept_desc>Software and its engineering~General programming languages</concept_desc>
% <concept_significance>500</concept_significance>
% </concept>
% <concept>
% <concept_id>10003456.10003457.10003521.10003525</concept_id>
% <concept_desc>Social and professional topics~History of programming languages</concept_desc>
% <concept_significance>300</concept_significance>
% </concept>
% </ccs2012>
% \end{CCSXML}
%
% \ccsdesc[500]{Software and its engineering~General programming languages}
% \ccsdesc[300]{Social and professional topics~History of programming languages}
% %% End of generated code

\keywords{R, Coq, Formalisation, Testing}

\maketitle

\section{Introduction}
\label{sec:intro}

R is used a lot.

R is complex.

We need to certify R softwares.

We need a formalisation of the language.

We aim to catch all the subtle cases of R.

This formalisation is quite large, and we need to certify it.

We use the same methodology than JSCert, with two ways to relate the formalisation to the R programming language:
\begin{itemize}
	\item Eyeball closeness;
	\item Testing.
\end{itemize}

\section{Coq Interpreter}
\abel{sec:coq:interp}

\subsection{Eyeball Closeness}
\label{sec:eyeball:closeness}

We extensively used state + error monads as well as monadic notations
to make every one or two lines of Coq corresponds to one or two lines of C.

Example of C definition / Coq definition.

Size of the project.

\subsection{Difficulties}
\label{sec:coq:difficulties}

C and Coq are widely different programming languages.

A simple model for C’s heap, with unions.
Accesses are unguarded in C, but guarded in Coq.

The [runs] trick to support looping in Coq in a structured way (similar to JSRef).

\subsection{Shim}
\label{sec:shim}

Issues with parsing.
How the parser itself is in a one-to-one correspondance with the original R parser.
Why this still doesn’t prevent us from difference in behaviour.

\section{Testing Architecture}
\label{sec:testing:architecture}

Two goals.
First providing trust to the formalisation by certifying the absence of bugs.
Second, help the development of the formalisation by catching bugs early.

\subsection{Methodology}
\label{sec:test:methodology}

Various kinds of tests (multiline, line-by-line, tests that are expected to fail, etc.).

What is considered to be a failure.

Including the base library.

\subsection{Results}
\label{sec:test:results}

How much tests are passed and failed.
What does this mean (one line can trigger more than one pass).

Other results (Potential fail, Not implemented) and how this helped the Coq development.

Bugs found (and where).

We extended the testing framework during development by adding new kinds of recognised
data structure.
We consider that the amount of work to extend the framework in another direction
(thus reducing the number of Unknown) is sufficiently low.

\section{Proofs}
\label{sec:proofs}

Tactic development.
Given the size of the formalisation, some of these proofs would never have been possible
without some proof automation.
Automation metric: size of the .vo / size of the .v.

Examples of properties that we have proven with our formalisation.

Example of tactic in action:
computeR after an allocation updating all the [safe_pointer], for instance.

\section{Related Work}
\label{sec:related:work}

FastR
genthat

JSCert

To a lesser extent, CompCert/Formaline.

\section{Conclusion and Future Work}
\label{sec:conclusion}

We have a fully trustable formalisation of R.

This formalisation can be used to prove program logic in R,
the amount of work for a direct approach being quite large.

We have a testing architecture that can be extended.

We believe our testing framework to be adaptable to other situations,
typically another programming language to be tested.

\printbibliography{}

\end{document}

